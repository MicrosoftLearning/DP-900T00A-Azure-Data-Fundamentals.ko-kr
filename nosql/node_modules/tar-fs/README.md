---
ms.openlocfilehash: 841a4ef811cc186a2302309fbbc4a380d1ba5cbd
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 02/05/2022
ms.locfileid: "138051968"
---
# <a name="tar-fs"></a>tar-fs

[tar-stream](https://github.com/mafintosh/tar-stream)에 대한 파일 시스템 바인딩입니다.

```
npm install tar-fs
```

[![빌드 상태](https://secure.travis-ci.org/mafintosh/tar-fs.png)](http://travis-ci.org/mafintosh/tar-fs)

## <a name="usage"></a>사용량

tar-fs를 사용하면 디렉터리를 tarball로 압축하고 tarball을 디렉터리로 추출할 수 있습니다.

자동으로 압축하지 않습니다. 따라서 이것으로 `.tar.gz`를 추출하려는 경우 이와 함께 [gunzip-maybe](https://github.com/mafintosh/gunzip-maybe)와 같은 항목을 사용해야 합니다.

``` js
var tar = require('tar-fs')
var fs = require('fs')

// packing a directory
tar.pack('./my-directory').pipe(fs.createWriteStream('my-tarball.tar'))

// extracting a directory
fs.createReadStream('my-other-tarball.tar').pipe(tar.extract('./my-other-directory'))
```

압축하거나 추출할 때 다양한 파일을 무시하려면 옵션에 ignore 함수를 추가합니다. `ignore`는 `filter`에 대한 별칭이기도 합니다. 또한 추출하는 동안 무시를 사용하는 경우 `header`를 얻을 수 있습니다.
이렇게 하면 메타데이터로 필터링할 수도 있습니다.

``` js
var pack = tar.pack('./my-directory', {
  ignore: function(name) {
    return path.extname(name) === '.bin' // ignore .bin files when packing
  }
})

var extract = tar.extract('./my-other-directory', {
  ignore: function(name) {
    return path.extname(name) === '.bin' // ignore .bin files inside the tarball when extracing
  }
})

var extractFilesDirs = tar.extract('./my-other-other-directory', {
  ignore: function(_, header) {
    // pass files & directories, ignore e.g. symlinks
    return header.type !== 'file' && header.type !== 'directory'
  }
})
```

`entries` 옵션을 사용하여 압축할 항목을 지정할 수도 있습니다.

```js
var pack = tar.pack('./my-directory', {
  entries: ['file1', 'subdir/file2'] // only the specific entries will be packed
})
```

압축/압축을 풀 때 헤더를 수정하려면 옵션에 지도 함수를 추가합니다.

``` js
var pack = tar.pack('./my-directory', {
  map: function(header) {
    header.name = 'prefixed/'+header.name
    return header
  }
})

var extract = tar.extract('./my-directory', {
  map: function(header) {
    header.name = 'another-prefix/'+header.name
    return header
  }
})
```

마찬가지로 입력/출력 파일 스트림을 수정하려는 `mapStream` incase를 사용할 수 있습니다.

``` js
var pack = tar.pack('./my-directory', {
  mapStream: function(fileStream, header) {
    // NOTE: the returned stream HAS to have the same length as the input stream.
    // If not make sure to update the size in the header passed in here.
    if (path.extname(header.name) === '.js') {
      return fileStream.pipe(someTransform)
    }
    return fileStream;
  }
})

var extract = tar.extract('./my-directory', {
  mapStream: function(fileStream, header) {
    if (path.extname(header.name) === '.js') {
      return fileStream.pipe(someTransform)
    }
    return fileStream;
  }
})
```

`options.fmode` 및 `options.dmode`를 설정하여 추출된 파일/디렉터리에 해당 모드가 있는지 확인

``` js
var extract = tar.extract('./my-directory', {
  dmode: parseInt(555, 8), // all dirs should be readable
  fmode: parseInt(444, 8) // all files should be readable
})
```

*nix/windows 간에 tarball을 압축/압축 해제하여 압축을 풀고 있는 경우 `dmode` 및 `fmode`를 사용하여 압축을 풀고 있는 모든 파일/디렉터리를 읽을 수 있도록 하는 것이 유용할 수 있습니다.

또는 `options.readable` 및/또는 `options.writable`을 설정하여 dmode 및 fmode를 읽기/쓰기 가능으로 설정할 수 있습니다.

``` js
var extract = tar.extract('./my-directory', {
  readable: true, // all dirs and files should be readable
  writable: true, // all dirs and files should be writable
})
```

지원되지 않는 항목 유형(예: 디바이스 파일)으로 인해 오류를 무시하려는 경우로 `options.strict`를 `false`로 설정합니다.

symlink를 역참조하려면(링크 자체 대신 symlink의 콘텐츠를 압축) 로`options.dereference`를 `true`로 설정합니다.

## <a name="copy-a-directory"></a>디렉터리 복사

권한과 mtime을 그대로 사용하여 디렉터리를 복사하는 것은 다음과 같이 간단합니다.

``` js
tar.pack('source-directory').pipe(tar.extract('dest-directory'))
```

## <a name="interaction-with-tar-stream"></a>[`tar-stream`](https://github.com/mafintosh/tar-stream)과 상호 작용

`finalize: false` 및 `finish` 후크를 사용하여 추가 항목([`tar-stream#pack`](https://github.com/mafintosh/tar-stream#packing) 참조)을 위해 팩 스트림을 열어 두고 `pack`을 사용하여 기존 팩 스트림을 전달합니다.

``` js
var mypack = tar.pack('./my-directory', {
  finalize: false,
  finish: function(sameAsMypack) {
    mypack.entry({name: 'generated-file.txt'}, "hello")
    tar.pack('./other-directory', {
      pack: sameAsMypack
    })
  }
})
```


## <a name="performance"></a>성능

2496개 디렉터리와 2398개 파일이 있는 6.1GB의 압축 및 추출은 내 Macbook Air에서 다음과 같은 결과를 생성합니다.
[여기에서 벤치마크 참조](https://gist.github.com/mafintosh/8102201)

* tar-fs: 34.261초
* [node-tar](https://github.com/isaacs/node-tar): 366.123초(또는 10배 더 느리게)

## <a name="license"></a>License

MIT
