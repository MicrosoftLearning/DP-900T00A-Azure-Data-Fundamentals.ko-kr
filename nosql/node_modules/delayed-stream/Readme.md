---
ms.openlocfilehash: 21db9b7ec97b7028a031a18867aab00575b09850
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 02/05/2022
ms.locfileid: "138053100"
---
# <a name="delayed-stream"></a>delayed-stream

처리할 준비가 될 때까지 스트림에서 이벤트를 버퍼링합니다.

## <a name="installation"></a>설치

``` bash
npm install delayed-stream
```

## <a name="usage"></a>사용량

다음 예제에서는 응답을 1,000ms 지연하는 http 에코 서버를 작성하는 방법을 보여 줍니다.

``` javascript
var DelayedStream = require('delayed-stream');
var http = require('http');

http.createServer(function(req, res) {
  var delayed = DelayedStream.create(req);

  setTimeout(function() {
    res.writeHead(200);
    delayed.pipe(res);
  }, 1000);
});
```

`Stream#pipe`를 사용하지 않는 경우 `delayedStream.resume()`을 호출하여 버퍼링된 이벤트를 수동으로 해제할 수도 있습니다.

``` javascript
var delayed = DelayedStream.create(req);

setTimeout(function() {
  // Emit all buffered events and resume underlaying source
  delayed.resume();
}, 1000);
```

## <a name="implementation"></a>구현

이 메타 스트림을 제대로 사용하려면 구현에 대해 알아야 할 몇 가지 사항이 있습니다.

### <a name="event-buffering--proxying"></a>이벤트 버퍼링 / 프록시

`source` 스트림의 모든 이벤트는 `source.emit` 메서드를 덮어써 하이재킹됩니다. 노드가 catch-all 이벤트 수신기를 구현할 때까지 이것이 유일한 방법입니다.

그러나 지연된 스트림은 아직 지연된 스트림을 해제했는지 여부에 관계없이 `source`에서 캡처한 모든 이벤트를 계속 내보냅니다.

생성 시 지연 스트림은 모든 `source` 이벤트를 캡처하고 내부 이벤트 버퍼에 저장합니다. `delayedStream.release()`가 호출되면 버퍼링된 모든 이벤트가 `delayedStream`에서 내보내지고 이벤트 버퍼가 지워집니다. 그 후 지연 스트림은 단지 언더레이 원본에 대한 프록시 역할을 합니다.

### <a name="error-handling"></a>오류 처리

`source`의 오류 이벤트는 다른 이벤트와 마찬가지로 버퍼링 / 프록시됩니다.
그러나 `delayedStream.create`는 no-op `'error'` 수신기를 `source`에 연결합니다. 이렇게 하면 두 위치가 아닌 `delayedStream` 개체의 오류만 처리할 수 있습니다.

### <a name="buffer-limits"></a>버퍼 한도

delay-stream은 버퍼링되는 데이터의 양을 제한하는 데 사용할 수 있는 `maxDataSize` 속성을 제공합니다. `source.pause()`에 반응하지 않는 잘못된 `source` 스트림으로부터 사용자를 보호하기 위해 이 기능은 기본적으로 사용하도록 설정됩니다.

## <a name="api"></a>API

### <a name="delayedstreamcreatesource-options"></a>DelayedStream.create(소스, [옵션])

새 `delayedStream`를 반환합니다. 사용 가능한 옵션은 다음과 같습니다.

* `pauseStream`
* `maxDataSize`

이러한 속성에 대한 설명은 아래에서 확인할 수 있습니다.

### <a name="delayedstreamsource"></a>delayedStream.source

이 개체에서 관리하는 `source` 스트림입니다. 이 기능은 `delayedStream`을 전달하고 `source` 개체의 속성에 계속 액세스하려는 경우에 유용합니다.

### <a name="delayedstreampausestream--true"></a>delayedStream.pauseStream = true

`DelayedStream.create()`를 호출할 때 언더레이 `source`를 일시 중지할지 여부입니다. 나중에 이 속성을 수정해도 아무런 효과가 없습니다.

### <a name="delayedstreammaxdatasize--1024--1024"></a>delayedStream.maxDataSize = 1024 * 1024

`error`를 내보내기 전에 버퍼링할 데이터의 양입니다.

언더레이 소스가 `Buffer` 개체를 내보내는 경우 `maxDataSize`는 바이트를 나타냅니다.

언더레이 소스가 JavaScript 문자열을 내보내는 경우 크기는 문자를 나타냅니다.

수행 중인 작업을 알고 있는 경우 이 속성을 `Infinity`로 설정하여 이 기능을 사용하지 않도록 설정할 수 있습니다. 런타임 중에 이 속성을 수정할 수도 있습니다.

### <a name="delayedstreamdatasize--0"></a>delayedStream.dataSize = 0

지금까지 버퍼링된 데이터의 양입니다.

### <a name="delayedstreamreadable"></a>delayedStream.readable

`source.readable` 값을 반환하는 ECMA5 getter입니다.

### <a name="delayedstreamresume"></a>delayedStream.resume()

지금까지 `delayedStream`이 릴리스되지 않은 경우 `delayedStream.release()`가 호출됩니다.

두 경우 모두 `source.resume()`이 호출됩니다.

### <a name="delayedstreampause"></a>delayedStream.pause()

`source.pause()`.

### <a name="delayedstreampipedest"></a>delayedStream.pipe(dest)

`delayedStream.resume()`을 호출한 다음, 인수를 `source.pipe`에 프록시합니다.

### <a name="delayedstreamrelease"></a>delayedStream.release()

지금까지 버퍼링된 모든 이벤트를 내보내고 지웁니다. 이 작업은 언더레이 소스를 다시 시작하지 않고 대신 `delayedStream.resume()`을 사용합니다.

## <a name="license"></a>License

delayed-stream은 MIT 라이선스에 따라 라이선스가 부여됩니다.
